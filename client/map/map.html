<template name="mapNew">
  <h1>Creating map</h1>
</template>

<template name="map">
  <nav class="nav">
    <h1>
      <a title="Home" class="btn btn-link btn-home" href="/">
        <i class="fa fa-home"></i>
      </a>
      {{>mapTitle}}
    </h1>
    {{>mapTimeframe}}
  </nav>

  {{#each priorities}}
    {{> priority}}
  {{/each}}

  {{> objectiveEdit objective}}
</template>

<template name="mapTitle">
  <span class="map-title">{{map.name}}</span>
  <span class="edit-map-title">
    <form>
      <input type="text" name="new-map-title" value="{{map.name}}" class="input-map-title" data-mapid="{{map._id}}">
    </form>
  </span>
</template>

<template name="mapTimeframe">
  <div id="map-timeframe">
    {{#if map.timeframe}}
    <i class="fa fa-clock-o"></i>
    <span class="map-timeframe">{{map.timeframe}}</span>
    {{else}}
    <a class="btn-link btn-map-timeframe" href="#">
      <i class="fa fa-clock-o"></i><sup><i class="fa fa-plus"></i></sup>
    </a>
    {{/if}}
    <span class="edit-map-timeframe">
      <form>
        <input type="text" name="new-map-timeframe" value="{{map.timeframe}}" class="input-map-timeframe" data-mapid="{{map._id}}">
      </form>
    </span>
  </div>
</template>

<template name="priority">
  <div class="priority {{slugify name}} {{#if isFull}}priority-full{{/if}}"
       data-priority="{{_id}}"
       draggable="{{#if isTrash}}false{{else}}true{{/if}}">

    <header class="priority-header">
      <h1 title="{{#unless isTrash}}Drag to re-prioritise{{/unless}}">
        {{name}}
      </h1>
    </header>
    <ul>
    {{#each slots}}
      <li class="slot {{#unless _id}}slot-empty{{/unless}}"
          title="{{#if _id}}Drag to re-prioritise{{else}}Click to add a objective{{/if}}"
          data-slot="{{preferredSlot}}" >
        {{#if _id}}
          {{> objective}}
        {{/if}}
      </li>
    {{/each}}
    </ul>
  </div>
</template>

<template name="objective">

  <div class="objective" draggable="true" data-objective="{{_id}}">
    <header>
      <h1>{{name}}</h1>
    </header>
    <p>{{truncate desc}}</p>
    {{#if leader}}
    <footer>
      <div class="leader" title="Leader">
        <i class="fa fa-user"></i> {{leader}}
      </div>
    </footer>
    {{/if}}
  </div>

  {{>popover}}

</template>

<template name="popover">
  <article class="popover">
    <h1 class="webui-popover-title">{{name}}</h1>
    {{#if desc}}
      <div class="field">
        <span class="label">Description</span>
        <span class="value">{{desc}}</span>
      </div>
    {{/if}}
    {{#if leader}}
      <div class="field">
        <span class="label">Leader</span>
        <span class="value">{{leader}}</span>
      </div>
    {{/if}}
    {{#if due}}
      <div class="field">
        <span class="label">Due date</span>
        <time class="value">{{due}}</time>
      </div>
    {{/if}}
    {{#if longdesc}}
      <div class="field">
        <span class="label">More Info</span>
        <span class="value longdesc">{{{longdesc}}}</span>
      </div>
    {{/if}}
  </article>
</template>

<template name="objectiveEdit">
  <div class="modal objective-edit {{#if show}}show{{/if}}">
    <header>
      <h1>Edit objective</h1>
      <button class="btn btn-link btn-close">
        <i class="fa fa-times"></i>
      </button>
    </header>
    <form>
      <div class="input-group">
        <label for="edit-objective-desc">Title</label>
        <input type="text" class="form-control" id="objective-edit-name" value="{{name}}" />
      </div>
      <div class="input-group">
        <label for="edit-objective-desc">Description</label>
        <input type="text" class="form-control" id="objective-edit-desc" value="{{desc}}"/>
      </div>
      <div class="input-group">
        <label for="edit-objective-leader">Leader</label>
        <input type="text" class="form-control" id="objective-edit-leader" value="{{leader}}" />
      </div>
      <div class="input-group">
        <label for="edit-objective-due">Due date</label>
        <input type="date" class="form-control" id="objective-edit-due" value="{{due}}" />
      </div>
      <div class="input-group">
        <label for="edit-objective-longdesc">More info</label>
        <textarea class="form-control" id="objective-edit-longdesc"></textarea>
      </div>
      <input type="submit" style="display:none;"/>
    </form>
    <footer>
      <button class="btn btn-link btn-trash" title="Move to trash">
        <i class="fa fa-trash"></i>
      </button>
      <button class="btn btn-link btn-cancel">Cancel</button>
      <button class="btn btn-primary btn-save">Save</button>
    </footer>
  </div>
</template>
